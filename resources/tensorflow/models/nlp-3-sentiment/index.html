
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../assets/dl-logo-big-512x512-color.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.5">
    
    
      
        <title>NLP - Multi-Class Sentiment Analysis - DrLiptons</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.a617204b.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.9204c3b2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/contact-style.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  <link rel="stylesheet" href="../../../../overrides/assets/stylesheets/main.d9227bb8.min.css">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#multi-class-natural-language-processing-sentiment-analysis-on-movie-reviews" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="DrLiptons" class="md-header__button md-logo" aria-label="DrLiptons" data-md-component="logo">
      
  <img src="../../../../assets/dl-logo-big-512x512-color.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DrLiptons
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NLP - Multi-Class Sentiment Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="" data-md-color-primary="indigo" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg>
            </label>
          
        
          
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../reference/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../../../resource/" class="md-tabs__link md-tabs__link--active">
        Resource
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../../../contact/" class="md-tabs__link">
      Contact
    </a>
  </li>

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="DrLiptons" class="md-nav__button md-logo" aria-label="DrLiptons" data-md-component="logo">
      
  <img src="../../../../assets/dl-logo-big-512x512-color.png" alt="logo">

    </a>
    DrLiptons
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../reference/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_2" type="checkbox" id="__nav_3_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_2">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/get-live-financial-data/" class="md-nav__link">
        Get Live Financial Data
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/flight-deals/" class="md-nav__link">
        Flight Deals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/alien-invaders/" class="md-nav__link">
        Alien Invaders
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/auto-job-app/" class="md-nav__link">
        Automated Job Application
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/price-tracker/" class="md-nav__link">
        Price Tracker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/password-manager/" class="md-nav__link">
        Password Manager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/text-2-morse-code/" class="md-nav__link">
        Text2MorseCode
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/stock-news-alerts/" class="md-nav__link">
        Stock News Alert
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/tetris/" class="md-nav__link">
        Tetris Clone
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3" type="checkbox" id="__nav_3_3" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3">
          TensorFlow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="TensorFlow" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_3">
          <span class="md-nav__icon md-icon"></span>
          TensorFlow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_3_1" type="checkbox" id="__nav_3_3_1" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_3_1">
          Plant Disease Detection
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plant Disease Detection" data-md-level="3">
        <label class="md-nav__title" for="__nav_3_3_1">
          <span class="md-nav__icon md-icon"></span>
          Plant Disease Detection
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/pdd/plant-disease-detection/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/pdd/part-1-create-ml-model/" class="md-nav__link">
        Part 1 - Create ML Model
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/pdd/part-2-create-app/" class="md-nav__link">
        Part 2 - Desktop App
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/pdd/part-3-make-exe/" class="md-nav__link">
        Part 3 - Make Executable
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/object-detection/" class="md-nav__link">
        Object Detection
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_4" type="checkbox" id="__nav_3_4" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3_4">
          Applications
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Applications" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_4">
          <span class="md-nav__icon md-icon"></span>
          Applications
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../references/untitled-project-1/pt/" class="md-nav__link">
        Untitled Project 1
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Resource
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Resource" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Resource
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../../resource/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_2" type="checkbox" id="__nav_4_2" >
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_2">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/scikit-learn/" class="md-nav__link">
        Scikit-Learn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/matplotlib/" class="md-nav__link">
        Matplotlib
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/numpy/" class="md-nav__link">
        Numpy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/pandas/" class="md-nav__link">
        Pandas
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../python/mplfinance/" class="md-nav__link">
        mplfinance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3" type="checkbox" id="__nav_4_3" checked>
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3">
          TensorFlow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="TensorFlow" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_3">
          <span class="md-nav__icon md-icon"></span>
          TensorFlow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1" type="checkbox" id="__nav_4_3_1" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_1">
          TensorFlow Exam
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="TensorFlow Exam" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_1">
          <span class="md-nav__icon md-icon"></span>
          TensorFlow Exam
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/tf-exam-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_1_2" type="checkbox" id="__nav_4_3_1_2" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_1_2">
          Coursera - DeepLearning.AI TensorFlow Developer
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Coursera - DeepLearning.AI TensorFlow Developer" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_1_2">
          <span class="md-nav__icon md-icon"></span>
          Coursera - DeepLearning.AI TensorFlow Developer
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/cs-part-1/" class="md-nav__link">
        Part 1 - Introduction to TF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/cs-part-2/" class="md-nav__link">
        Part 2 - CNN in TF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/cs-part-3/" class="md-nav__link">
        Part 3 -  NLP in TF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/cs-part-4/" class="md-nav__link">
        Part 4 - Time Series
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-exam/pass-tensorflow-cert/" class="md-nav__link">
        How I past TensorFlow Exam
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tf-model-bp/" class="md-nav__link">
        TensorFlow Blueprint
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3" type="checkbox" id="__nav_4_3_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3">
          TensorFlow Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="TensorFlow Models" data-md-level="3">
        <label class="md-nav__title" for="__nav_4_3_3">
          <span class="md-nav__icon md-icon"></span>
          TensorFlow Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../model-list/" class="md-nav__link">
        List of Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3_2" type="checkbox" id="__nav_4_3_3_2" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3_2">
          Neural Network Regressions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Neural Network Regressions" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_3_2">
          <span class="md-nav__icon md-icon"></span>
          Neural Network Regressions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simple-regression/" class="md-nav__link">
        NNR - House Prices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../regression-boston-housing/" class="md-nav__link">
        NNR - Boston Housing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../titanic/" class="md-nav__link">
        NNR - Titanic
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3_3" type="checkbox" id="__nav_4_3_3_3" >
      
      
      
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3_3">
          Image Classification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Image Classification" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_3_3">
          <span class="md-nav__icon md-icon"></span>
          Image Classification
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../basic-fmnist/" class="md-nav__link">
        Basic Image Classification - FMNIST
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../image-classification-dogs-cats/" class="md-nav__link">
        Image Classification - Dogs & Cats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cnn-fmnist/" class="md-nav__link">
        CNN - FMNIST
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3_4" type="checkbox" id="__nav_4_3_3_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3_4">
          Natural Language Processing
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Natural Language Processing" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_3_4">
          <span class="md-nav__icon md-icon"></span>
          Natural Language Processing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../imdb/" class="md-nav__link">
        NLP - Binary-Class IMDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-1-binary/" class="md-nav__link">
        NLP - Binary-Class Disaster Tweets
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nlp-2-multi/" class="md-nav__link">
        NLP - Multi-Class PedMed
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          NLP - Multi-Class Sentiment Analysis
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        NLP - Multi-Class Sentiment Analysis
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance" class="md-nav__link">
    At a Glance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-dependencies" class="md-nav__link">
    Import Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-data-from-kaggle" class="md-nav__link">
    Download Data from Kaggle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-data" class="md-nav__link">
    Prepare Data
  </a>
  
    <nav class="md-nav" aria-label="Prepare Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unzip-data" class="md-nav__link">
    Unzip Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-data" class="md-nav__link">
    Visualize Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split-data-into-sets" class="md-nav__link">
    Split Data into Sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-text-into-numbers" class="md-nav__link">
    Convert Text into Numbers
  </a>
  
    <nav class="md-nav" aria-label="Convert Text into Numbers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tokenization" class="md-nav__link">
    Tokenization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding" class="md-nav__link">
    Embedding
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    Utility Functions
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculate-result" class="md-nav__link">
    Calculate Result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-0-base-model" class="md-nav__link">
    Model 0: Base Model
  </a>
  
    <nav class="md-nav" aria-label="Model 0: Base Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-1-dense-model" class="md-nav__link">
    Model 1: Dense Model
  </a>
  
    <nav class="md-nav" aria-label="Model 1: Dense Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_1" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_1" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-2-lstm-model" class="md-nav__link">
    Model 2: LSTM Model
  </a>
  
    <nav class="md-nav" aria-label="Model 2: LSTM Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_2" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_2" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-3-gru-model" class="md-nav__link">
    Model 3: GRU Model
  </a>
  
    <nav class="md-nav" aria-label="Model 3: GRU Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_3" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_3" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-4-bi-directional-lstm-model" class="md-nav__link">
    Model 4: Bi-Directional-LSTM Model
  </a>
  
    <nav class="md-nav" aria-label="Model 4: Bi-Directional-LSTM Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_4" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_4" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-5-1d-cnn" class="md-nav__link">
    Model 5: 1D CNN
  </a>
  
    <nav class="md-nav" aria-label="Model 5: 1D CNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_5" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_5" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-6-tensorflow-hub-pretrained-model-use" class="md-nav__link">
    Model 6: TensorFlow Hub Pretrained Model (USE)
  </a>
  
    <nav class="md-nav" aria-label="Model 6: TensorFlow Hub Pretrained Model (USE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_6" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_6" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-7-kaggle-model" class="md-nav__link">
    Model 7: Kaggle Model
  </a>
  
    <nav class="md-nav" aria-label="Model 7: Kaggle Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_7" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_7" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-all-models" class="md-nav__link">
    Compare All Models
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3_5" type="checkbox" id="__nav_4_3_3_5" >
      
      
      
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3_5">
          Time Series
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Time Series" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_3_5">
          <span class="md-nav__icon md-icon"></span>
          Time Series
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ts-bitcoin/" class="md-nav__link">
        Time Series - Bitcoin Price Forecast
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ts-weather/" class="md-nav__link">
        Time Series - Weather Forecast
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_3_3_6" type="checkbox" id="__nav_4_3_3_6" >
      
      
      
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_3_3_6">
          Miscellaneous
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Miscellaneous" data-md-level="4">
        <label class="md-nav__title" for="__nav_4_3_3_6">
          <span class="md-nav__icon md-icon"></span>
          Miscellaneous
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utilities/" class="md-nav__link">
        Utility Functions
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4_4" type="checkbox" id="__nav_4_4" >
      
      
      
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4_4">
          Microsoft Certification
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Microsoft Certification" data-md-level="2">
        <label class="md-nav__title" for="__nav_4_4">
          <span class="md-nav__icon md-icon"></span>
          Microsoft Certification
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ms/ms-overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ms/az-900/" class="md-nav__link">
        Azure Fundamentals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ms/ai-900/" class="md-nav__link">
        Azure AI Fundamentals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../ms/dp-900/" class="md-nav__link">
        Azure Data Fundamentals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../contact/" class="md-nav__link">
        Contact
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance" class="md-nav__link">
    At a Glance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-dependencies" class="md-nav__link">
    Import Dependencies
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#download-data-from-kaggle" class="md-nav__link">
    Download Data from Kaggle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prepare-data" class="md-nav__link">
    Prepare Data
  </a>
  
    <nav class="md-nav" aria-label="Prepare Data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unzip-data" class="md-nav__link">
    Unzip Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize-data" class="md-nav__link">
    Visualize Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#split-data-into-sets" class="md-nav__link">
    Split Data into Sets
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-text-into-numbers" class="md-nav__link">
    Convert Text into Numbers
  </a>
  
    <nav class="md-nav" aria-label="Convert Text into Numbers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tokenization" class="md-nav__link">
    Tokenization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#embedding" class="md-nav__link">
    Embedding
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utility-functions" class="md-nav__link">
    Utility Functions
  </a>
  
    <nav class="md-nav" aria-label="Utility Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#calculate-result" class="md-nav__link">
    Calculate Result
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-0-base-model" class="md-nav__link">
    Model 0: Base Model
  </a>
  
    <nav class="md-nav" aria-label="Model 0: Base Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-1-dense-model" class="md-nav__link">
    Model 1: Dense Model
  </a>
  
    <nav class="md-nav" aria-label="Model 1: Dense Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_1" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_1" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-2-lstm-model" class="md-nav__link">
    Model 2: LSTM Model
  </a>
  
    <nav class="md-nav" aria-label="Model 2: LSTM Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_2" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_2" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-3-gru-model" class="md-nav__link">
    Model 3: GRU Model
  </a>
  
    <nav class="md-nav" aria-label="Model 3: GRU Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_3" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_3" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-4-bi-directional-lstm-model" class="md-nav__link">
    Model 4: Bi-Directional-LSTM Model
  </a>
  
    <nav class="md-nav" aria-label="Model 4: Bi-Directional-LSTM Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_4" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_4" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-5-1d-cnn" class="md-nav__link">
    Model 5: 1D CNN
  </a>
  
    <nav class="md-nav" aria-label="Model 5: 1D CNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_5" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_5" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-6-tensorflow-hub-pretrained-model-use" class="md-nav__link">
    Model 6: TensorFlow Hub Pretrained Model (USE)
  </a>
  
    <nav class="md-nav" aria-label="Model 6: TensorFlow Hub Pretrained Model (USE)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_6" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_6" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-7-kaggle-model" class="md-nav__link">
    Model 7: Kaggle Model
  </a>
  
    <nav class="md-nav" aria-label="Model 7: Kaggle Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-compile-and-run-model_7" class="md-nav__link">
    Create, Compile, and Run Model
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#evaluate-model_7" class="md-nav__link">
    Evaluate Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-all-models" class="md-nav__link">
    Compare All Models
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

<h1 id="multi-class-natural-language-processing-sentiment-analysis-on-movie-reviews">Multi-Class Natural Language Processing Sentiment Analysis on Movie Reviews</h1>
<h2 id="at-a-glance"><b>At a Glance</b></h2>
<details class="example" open="open">
<summary>What to expect</summary>
<ul>
<li><a href="#model-0">Model 0: Base Model</a></li>
<li><a href="#model-1">Model 1: Dense Model</a></li>
<li><a href="#model-2">Model 2: LSTM Model</a></li>
<li><a href="#model-3">Model 3: GRU Model</a></li>
<li><a href="#model-4">Model 4: Bi-Directional-LSTM Model</a></li>
<li><a href="#model-5">Model 5: 1D CNN</a></li>
<li><a href="#model-6">Model 6: TensorFlow Hub Pretrained Model (USE)</a></li>
<li><a href="#model-7">Model 7: Kaggle Model</a></li>
<li><a href="#compare-models">Compare all Models</a></li>
</ul>
</details>
<p><a name="import"></a></p>
<h2 id="import-dependencies"><strong>Import Dependencies</strong></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># Kaggle</span>
<a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="c1"># General</span>
<a id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="kn">import</span> <span class="nn">random</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="c1"># Prepare datasets</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="c1"># Tokenization</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="kn">from</span> <span class="nn">tensorflow.keras.layers.experimental.preprocessing</span> <span class="kn">import</span> <span class="n">TextVectorization</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="c1"># For model</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="kn">import</span> <span class="nn">tensorflow_hub</span> <span class="k">as</span> <span class="nn">hub</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="c1"># Evaluate model</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_recall_fscore_support</span>
</code></pre></div>
</td></tr></table>
<p><a name="download"></a></p>
<h2 id="download-data-from-kaggle"><strong>Download Data from Kaggle</strong></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
                Upload widget is only available when the cell has been executed in the current browser session. Please rerun this cell to enable.
    Saving kaggle.json to kaggle.json
    {'kaggle.json': b'{"username":"drliptons","key":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"}'}
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="err">!</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">kaggle</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Requirement already satisfied: kaggle in /usr/local/lib/python3.7/dist-packages (1.5.12)
    Requirement already satisfied: urllib3 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.24.3)
    Requirement already satisfied: six>=1.10 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.15.0)
    Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.23.0)
    Requirement already satisfied: python-dateutil in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.8.2)
    Requirement already satisfied: python-slugify in /usr/local/lib/python3.7/dist-packages (from kaggle) (5.0.2)
    Requirement already satisfied: certifi in /usr/local/lib/python3.7/dist-packages (from kaggle) (2021.10.8)
    Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from kaggle) (4.62.3)
    Requirement already satisfied: text-unidecode>=1.3 in /usr/local/lib/python3.7/dist-packages (from python-slugify->kaggle) (1.3)
    Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->kaggle) (3.0.4)
    Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->kaggle) (2.10)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># Update kaggle</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1">#! pip install --upgrade kaggle</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Requirement already satisfied: kaggle in /usr/local/lib/python3.7/dist-packages (1.5.12)
    Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.23.0)
    Requirement already satisfied: python-dateutil in /usr/local/lib/python3.7/dist-packages (from kaggle) (2.8.2)
    Requirement already satisfied: certifi in /usr/local/lib/python3.7/dist-packages (from kaggle) (2021.10.8)
    Requirement already satisfied: python-slugify in /usr/local/lib/python3.7/dist-packages (from kaggle) (5.0.2)
    Requirement already satisfied: six>=1.10 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.15.0)
    Requirement already satisfied: tqdm in /usr/local/lib/python3.7/dist-packages (from kaggle) (4.62.3)
    Requirement already satisfied: urllib3 in /usr/local/lib/python3.7/dist-packages (from kaggle) (1.24.3)
    Requirement already satisfied: text-unidecode>=1.3 in /usr/local/lib/python3.7/dist-packages (from python-slugify->kaggle) (1.3)
    Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->kaggle) (2.10)
    Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->kaggle) (3.0.4)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># Make new directory</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="err">!</span> <span class="n">mkdir</span> <span class="o">~/.</span><span class="n">kaggle</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="c1"># Copy and paste kaggle.json file into /.kaggle</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="err">!</span> <span class="n">cp</span> <span class="n">kaggle</span><span class="o">.</span><span class="n">json</span> <span class="o">~/.</span><span class="n">kaggle</span><span class="o">/</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="c1"># Change permission od the file</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="err">!</span> <span class="n">chmod</span> <span class="mi">600</span> <span class="o">~/.</span><span class="n">kaggle</span><span class="o">/</span><span class="n">kaggle</span><span class="o">.</span><span class="n">json</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a> <span class="c1"># Check all datasets</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="err">!</span> <span class="n">kaggle</span> <span class="n">datasets</span> <span class="nb">list</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Warning: Looks like you're using an outdated API Version, please consider updating (server 1.5.12 / client 1.5.4)
    ref                                                         title                                              size  lastUpdated          downloadCount  
    ----------------------------------------------------------  ------------------------------------------------  -----  -------------------  -------------  
    imsparsh/musicnet-dataset                                   MusicNet Dataset                                   22GB  2021-02-18 14:12:19           5364  
    promptcloud/careerbuilder-job-listing-2020                  Careerbuilder Job Listing 2020                     42MB  2021-03-05 06:59:52           3020  
    nickuzmenkov/nih-chest-xrays-tfrecords                      NIH Chest X-rays TFRecords                         11GB  2021-03-09 04:49:23           1864  
    fatiimaezzahra/famous-iconic-women                          Famous Iconic Women                               838MB  2021-02-28 14:56:00           2143  
    coloradokb/dandelionimages                                  DandelionImages                                     4GB  2021-02-19 20:03:47           1102  
    simiotic/github-code-snippets                               GitHub Code Snippets                                7GB  2021-03-03 11:34:39            558  
    alsgroup/end-als                                            End ALS Kaggle Challenge                           12GB  2021-04-08 12:16:37           1169  
    landrykezebou/lvzhdr-tone-mapping-benchmark-dataset-tmonet  LVZ-HDR Tone Mapping Benchmark Dataset (TMO-Net)   24GB  2021-03-01 05:03:40            273  
    nickuzmenkov/ranzcr-clip-kfold-tfrecords                    RANZCR CLiP KFold TFRecords                         2GB  2021-02-21 13:29:51            171  
    stuartjames/lights                                          LightS: Light Specularity Dataset                  18GB  2021-02-18 14:32:26            253  
    imsparsh/accentdb-core-extended                             AccentDB - Core & Extended                          6GB  2021-02-17 14:22:54            203  
    datasnaek/youtube-new                                       Trending YouTube Video Statistics                 201MB  2019-06-03 00:56:47         161931  
    zynicide/wine-reviews                                       Wine Reviews                                       51MB  2017-11-27 17:08:04         151356  
    residentmario/ramen-ratings                                 Ramen Ratings                                      40KB  2018-01-11 16:04:39          31315  
    datasnaek/chess                                             Chess Game Dataset (Lichess)                        3MB  2017-09-04 03:09:09          26456  
    rtatman/188-million-us-wildfires                            1.88 Million US Wildfires                         168MB  2020-05-12 21:03:49          18386  
    nasa/kepler-exoplanet-search-results                        Kepler Exoplanet Search Results                     1MB  2017-10-10 18:26:59           9618  
    residentmario/things-on-reddit                              Things on Reddit                                   16MB  2017-10-26 14:10:15           7894  
    nolanbconaway/pitchfork-data                                18,393 Pitchfork Reviews                           33MB  2017-01-13 04:18:10           9852  
    ronitf/heart-disease-uci                                    Heart Disease UCI                                   3KB  2018-06-25 11:33:56         267053 
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># Make sure that you have accepted the rules of the dataset before download</span>
<a id="__codelineno-8-2" name="__codelineno-8-2"></a><span class="err">!</span> <span class="n">kaggle</span> <span class="n">competitions</span> <span class="n">download</span> <span class="n">sentiment</span><span class="o">-</span><span class="n">analysis</span><span class="o">-</span><span class="n">on</span><span class="o">-</span><span class="n">movie</span><span class="o">-</span><span class="n">reviews</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Warning: Looks like you're using an outdated API Version, please consider updating (server 1.5.12 / client 1.5.4)
    Downloading test.tsv.zip to /content
      0% 0.00/494k [00:00?, ?B/s]
    100% 494k/494k [00:00, 32.4MB/s]
    Downloading sampleSubmission.csv to /content
      0% 0.00/583k [00:00?, ?B/s]
    100% 583k/583k [00:00, 38.4MB/s]
    Downloading train.tsv.zip to /content
      0% 0.00/1.28M [00:00?, ?B/s]
    100% 1.28M/1.28M [00:00<00:00, 87.3MB/s]
</pre>
</div>

<p><a name="prepare"></a></p>
<h2 id="prepare-data"><strong>Prepare Data</strong></h2>
<p><a name="unzip"></a></p>
<h3 id="unzip-data">Unzip Data</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="err">!</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">unzip</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Reading package lists... Done
    Building dependency tree       
    Reading state information... Done
    unzip is already the newest version (6.0-21ubuntu1.1).
    0 upgraded, 0 newly installed, 0 to remove and 37 not upgraded.
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span>
<span class="normal"><a href="#__codelineno-10-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="err">!</span><span class="n">unzip</span> <span class="o">../</span><span class="n">content</span><span class="o">/</span><span class="n">test</span><span class="o">.</span><span class="n">tsv</span><span class="o">.</span><span class="n">zip</span> <span class="n">test</span><span class="o">.</span><span class="n">tsv</span>
<a id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="err">!</span><span class="n">unzip</span> <span class="o">../</span><span class="n">content</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">tsv</span><span class="o">.</span><span class="n">zip</span> <span class="n">train</span><span class="o">.</span><span class="n">tsv</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Archive:  ../content/test.tsv.zip
      inflating: test.tsv                
    Archive:  ../content/train.tsv.zip
      inflating: train.tsv  
</pre>
</div>

<p><a name="visualize"></a></p>
<h3 id="visualize-data">Visualize Data</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;sampleSubmission.csv&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="nb">len</span><span class="p">(</span><span class="n">sample_df</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    66292
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="n">sample_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
        PhraseId    Sentiment
    0   156061      2
    1   156062      2
    2   156063      2
    3   156064      2
    4   156065      2
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="n">sample_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
            PhraseId    Sentiment
    66287   222348      2
    66288   222349      2
    66289   222350      2
    66290   222351      2
    66291   222352      2
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;train.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;test.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="n">train_df</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (class 'pandas.core.frame.DataFrame')
    RangeIndex: 156060 entries, 0 to 156059
    Data columns (total 4 columns):
     #   Column      Non-Null Count   Dtype 
    ---  ------      --------------   ----- 
     0   PhraseId    156060 non-null  int64 
     1   SentenceId  156060 non-null  int64 
     2   Phrase      156060 non-null  object
     3   Sentiment   156060 non-null  int64 
    dtypes: int64(3), object(1)
    memory usage: 4.8+ MB
    ((156060, 4), None)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="nb">len</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    156060
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="nb">len</span><span class="p">(</span><span class="n">test_df</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    66292
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="n">train_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
        PhraseId    SentenceId  Phrase                                              Sentiment
    0       1       1           A series of escapades demonstrating the adage ...   1
    1       2       1           A series of escapades demonstrating the adage ...   2
    2       3       1           A series                                            2
    3       4       1           A                                                   2
    4       5       1           series                                              2
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="n">test_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
        PhraseId    SentenceId  Phrase
    0   156061      8545        An intermittently pleasing but mostly routine ...
    1   156062      8545        An intermittently pleasing but mostly routine ...
    2   156063      8545        An
    3   156064      8545        intermittently pleasing but mostly routine effort
    4   156065      8545        intermittently pleasing but mostly routine
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="n">train_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
            PhraseId    SentenceId  Phrase                      Sentiment
    156055  156056      8544        Hearst 's                   2
    156056  156057      8544        forced avuncular chortles   1
    156057  156058      8544        avuncular chortles          3
    156058  156059      8544        avuncular                   2
    156059  156060      8544        chortles                    2
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="n">test_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
            PhraseId    SentenceId  Phrase
    66287   222348      11855       A long-winded , predictable scenario .
    66288   222349      11855       A long-winded , predictable scenario
    66289   222350      11855       A long-winded ,
    66290   222351      11855       A long-winded
    66291   222352      11855       predictable scenario
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1"># Sentiments</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="n">num_classes</span> <span class="o">=</span> <span class="mi">5</span>
</code></pre></div>
</td></tr></table>
<p><a name="split"></a></p>
<h3 id="split-data-into-sets">Split Data into Sets</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1">1</a></span>
<span class="normal"><a href="#__codelineno-24-2">2</a></span>
<span class="normal"><a href="#__codelineno-24-3">3</a></span>
<span class="normal"><a href="#__codelineno-24-4">4</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="n">train_sentences</span><span class="p">,</span> <span class="n">val_sentences</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> <span class="n">val_labels</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Phrase&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>                                                                            <span class="n">train_df</span><span class="p">[</span><span class="s2">&quot;Sentiment&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>                                                                            <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>                                                                            <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="nb">len</span><span class="p">(</span><span class="n">train_sentences</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_sentences</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_labels</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_labels</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (124848, 31212, 124848, 31212)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="n">train_sentences</span><span class="p">[:</span><span class="mi">5</span><span class="p">],</span> <span class="n">train_labels</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (array(['cheesy', 'unintentionally -RRB-',
            "will need all the luck they can muster just figuring out who 's who in this pretentious mess",
            'somewhere between Sling Blade and South of Heaven , West of Hell',
            "reminds at every turn of Elizabeth Berkley 's flopping dolphin-gasm"],
           dtype=object), array([1, 2, 0, 2, 1]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="n">one_hot_encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="n">train_labels_one_hot</span> <span class="o">=</span> <span class="n">one_hot_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_labels</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="n">val_labels_one_hot</span> <span class="o">=</span> <span class="n">one_hot_encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">val_labels</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1">1</a></span>
<span class="normal"><a href="#__codelineno-28-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">train_sentences</span><span class="p">,</span> <span class="n">train_labels_one_hot</span><span class="p">))</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a><span class="n">val_dataset</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_tensor_slices</span><span class="p">((</span><span class="n">val_sentences</span><span class="p">,</span> <span class="n">val_labels_one_hot</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="n">train_dataset</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (TensorSliceDataset shapes: ((), (5,)), types: (tf.string, tf.float64))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="n">val_dataset</span> <span class="o">=</span> <span class="n">val_dataset</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">prefetch</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">AUTOTUNE</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="n">train_dataset</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (PrefetchDataset shapes: ((None,), (None, 5)), types: (tf.string, tf.float64))
</pre>
</div>

<p><a name="convert"></a></p>
<h3 id="convert-text-into-numbers">Convert Text into Numbers</h3>
<p><a name="token"></a></p>
<h4 id="tokenization">Tokenization</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span>
<span class="normal"><a href="#__codelineno-32-7">7</a></span>
<span class="normal"><a href="#__codelineno-32-8">8</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="c1">## [Example] Create Tokenization layer</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="c1"># text_vectorizer = TextVectorization(max_tokens=None, # how many words in the vocab</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="c1">#                                     standardize=&quot;lower_and_strip_punctuation&quot;, # how to process text</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="c1">#                                     split=&quot;whitespace&quot;, # how to split tokens</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="c1">#                                     ngrams=None, # create groups of n-words?</span>
<a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="c1">#                                     output_mode=&quot;int&quot;, # hot to map tokens to words</span>
<a id="__codelineno-32-7" name="__codelineno-32-7"></a><span class="c1">#                                     output_sequence_length=None # how long should the sequence of tokens be?</span>
<a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="c1">#                                     )</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="c1"># How long is a sentence?</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="nb">round</span><span class="p">(</span><span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">train_sentences</span><span class="p">])</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_sentences</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    7
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span>
<span class="normal"><a href="#__codelineno-34-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="c1"># Max number of words to have in our vocabulary</span>
<a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="n">max_vocab_length</span> <span class="o">=</span> <span class="mi">10000</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1">1</a></span>
<span class="normal"><a href="#__codelineno-35-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="c1"># Max length of our sequences will be</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="n">max_length</span> <span class="o">=</span> <span class="mi">7</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="c1"># Create Tokenization</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a><span class="n">text_vectorizer</span> <span class="o">=</span> <span class="n">TextVectorization</span><span class="p">(</span><span class="n">max_tokens</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-36-3" name="__codelineno-36-3"></a>                                    <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;int&quot;</span><span class="p">,</span>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a>                                    <span class="n">output_sequence_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1"># Fit the text vectorizer to the training text</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="n">text_vectorizer</span><span class="o">.</span><span class="n">adapt</span><span class="p">(</span><span class="n">train_sentences</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span>
<span class="normal"><a href="#__codelineno-38-5">5</a></span>
<span class="normal"><a href="#__codelineno-38-6">6</a></span>
<span class="normal"><a href="#__codelineno-38-7">7</a></span>
<span class="normal"><a href="#__codelineno-38-8">8</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="c1"># [Visualize] Take a look of the text_vectorizer</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a><span class="n">words_in_vocab</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="o">.</span><span class="n">get_vocabulary</span><span class="p">()</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a><span class="n">top_5_words</span> <span class="o">=</span> <span class="n">words_in_vocab</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="n">bottom_5_words</span> <span class="o">=</span> <span class="n">words_in_vocab</span><span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<a id="__codelineno-38-5" name="__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of words in vocab: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">words_in_vocab</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Top 5 most common words: </span><span class="si">{</span><span class="n">top_5_words</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> 
<a id="__codelineno-38-8" name="__codelineno-38-8"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bottom 5 least common words: </span><span class="si">{</span><span class="n">bottom_5_words</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Number of words in vocab: 10000
    Top 5 most common words: ['', '[UNK]', 'the', 'a', 'of']
    Bottom 5 least common words: ['guiding', 'groove', 'groen', 'grieving', 'graphics']
</pre>
</div>

<p><a name="embed"></a></p>
<h4 id="embedding">Embedding</h4>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span>
<span class="normal"><a href="#__codelineno-39-3">3</a></span>
<span class="normal"><a href="#__codelineno-39-4">4</a></span>
<span class="normal"><a href="#__codelineno-39-5">5</a></span>
<span class="normal"><a href="#__codelineno-39-6">6</a></span>
<span class="normal"><a href="#__codelineno-39-7">7</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a>
<a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="n">embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span> <span class="c1"># set input shape</span>
<a id="__codelineno-39-4" name="__codelineno-39-4"></a>                                      <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="c1"># size of embedding vector</span>
<a id="__codelineno-39-5" name="__codelineno-39-5"></a>                                      <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span> <span class="c1"># default, initilze ramdomly</span>
<a id="__codelineno-39-6" name="__codelineno-39-6"></a>                                      <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span> <span class="c1"># how long is each input</span>
<a id="__codelineno-39-7" name="__codelineno-39-7"></a>                                      <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span>
<span class="normal"><a href="#__codelineno-40-5">5</a></span>
<span class="normal"><a href="#__codelineno-40-6">6</a></span>
<span class="normal"><a href="#__codelineno-40-7">7</a></span>
<span class="normal"><a href="#__codelineno-40-8">8</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="c1"># [Visualize] Get a random sentence from training set</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a><span class="n">random_sentence</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">train_sentences</span><span class="p">)</span>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original text:</span><span class="se">\n</span><span class="si">{</span><span class="n">random_sentence</span><span class="si">}</span><span class="se">\</span>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="s2">      </span><span class="se">\n\n</span><span class="s2">Embedded version:&quot;</span><span class="p">)</span>
<a id="__codelineno-40-5" name="__codelineno-40-5"></a>
<a id="__codelineno-40-6" name="__codelineno-40-6"></a><span class="c1"># Embed the random sentence (turn it into numerical representation)</span>
<a id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="n">sample_embed</span> <span class="o">=</span> <span class="n">embedding</span><span class="p">(</span><span class="n">text_vectorizer</span><span class="p">([</span><span class="n">random_sentence</span><span class="p">]))</span>
<a id="__codelineno-40-8" name="__codelineno-40-8"></a><span class="n">sample_embed</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
Original text:
something that does n't feel like a half-baked stand-up routine      

Embedded version:
    (tf.Tensor: shape=(1, 7, 128), dtype=float32, numpy=
    array(||| 3.65578420e-02, -4.70690988e-02, -3.58556993e-02,
              1.53235309e-02, -2.57562399e-02,  2.67158411e-02,
             -1.78992525e-02,  1.32009499e-02, -2.07022578e-03,
             -7.27136061e-03, -3.90294194e-02,  5.94977289e-03,
             -4.84187976e-02,  1.19826943e-03, -5.47003746e-03,
             -2.42649801e-02,  5.22910431e-03, -4.36126254e-02,
              1.88815333e-02, -2.63978597e-02, -3.73220667e-02,
              1.53816007e-02, -1.72861218e-02, -2.77591348e-02,
             -3.96023877e-02,  4.14643995e-02, -4.98789549e-03,
             -2.69097332e-02, -2.61827949e-02,  4.34890650e-02,
             -1.05178133e-02,  2.39170529e-02, -2.91549563e-02,
             -3.84371392e-02,  7.37667084e-04, -3.55441570e-02,
              1.53974928e-02, -1.04865804e-02,  1.87321790e-02,
              ...
             -3.84137742e-02, -1.83001049e-02, -1.02417953e-02,
              1.09584704e-02,  2.50273012e-02, -1.54264793e-02,
             -1.77286752e-02, -1.21302009e-02,  4.17565592e-02,
              2.18983032e-02,  3.27894837e-03,  2.87661441e-02,
              4.70233001e-02, -2.17160936e-02,  3.21032666e-02,
             -3.59798074e-02,  4.38648500e-02, -2.58739349e-02,
             -2.87870765e-02,  6.71787187e-03, -1.14086755e-02,
             -1.84548870e-02,  4.01657820e-03,  1.12389810e-02,
              4.43519019e-02, -1.75215490e-02, -1.66401155e-02,
             -1.70699134e-02,  2.20570080e-02, -1.04143471e-03,
              3.92369963e-02, -3.08631901e-02, -1.96486600e-02,
             -4.77685779e-03, -3.02610546e-03,  1.10451952e-02,
             -2.80846711e-02, -2.59781964e-02, -1.16610639e-02,
              3.06106247e-02,  1.97214819e-02]]], dtype=float32))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="c1"># [Visualize] Check out a single token&#39;s embedding</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="n">sample_embed</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(128,), dtype=float32, numpy=
    array([ 0.03655784, -0.0470691 , -0.0358557 ,  0.01532353, -0.02575624,
            0.02671584, -0.01789925,  0.01320095, -0.00207023, -0.00727136,
           -0.03902942,  0.00594977, -0.0484188 ,  0.00119827, -0.00547004,
           -0.02426498,  0.0052291 , -0.04361263,  0.01888153, -0.02639786,
           -0.03732207,  0.0153816 , -0.01728612, -0.02775913, -0.03960239,
            0.0414644 , -0.0049879 , -0.02690973, -0.02618279,  0.04348907,
           -0.01051781,  0.02391705, -0.02915496, -0.03843714,  0.00073767,
           -0.03554416,  0.01539749, -0.01048658,  0.01873218, -0.03880218,
           -0.03097137,  0.02289707,  0.01557368, -0.01929532,  0.01930999,
           -0.00234459, -0.01236994,  0.00887737, -0.00748143,  0.00406369,
            0.04205548, -0.00280596, -0.01313574, -0.03517098, -0.04984571,
           -0.03199781,  0.03486248,  0.01441207, -0.03215067, -0.04005583,
            0.03863696, -0.02084978,  0.00563155,  0.00899116, -0.0298092 ,
           -0.04925908, -0.03349318,  0.02933281, -0.03470217,  0.03204185,
           -0.03817382, -0.03681531, -0.04972656, -0.02028102,  0.01308474,
           -0.02141714,  0.0310072 , -0.01870661, -0.00290464,  0.03381047,
           -0.03695812, -0.01142345,  0.01899728,  0.02801685,  0.02999068,
            0.04443724,  0.04051406, -0.04093102, -0.0288456 , -0.02199661,
            0.00973723,  0.0438875 ,  0.01737592,  0.00859626,  0.00860306,
            0.00227275, -0.01208397,  0.04084433,  0.0077477 , -0.01010593,
            0.03448078,  0.00049008, -0.03525463,  0.01569077,  0.03072064,
            0.0270456 ,  0.00532311,  0.03788239,  0.03068702, -0.01120041,
           -0.03244078,  0.0325081 , -0.00726281,  0.01630213, -0.01553298,
           -0.04637641, -0.02175643, -0.00848734, -0.04152592,  0.03157679,
           -0.04109611,  0.03407996,  0.00262917, -0.00540658,  0.00304742,
            0.04665167,  0.0426494 ,  0.0220886 ], dtype=float32))
</pre>
</div>

<p><a name="util"></a></p>
<h2 id="utility-functions"><strong>Utility Functions</strong></h2>
<p><a name="calculate"></a></p>
<h3 id="calculate-result">Calculate Result</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-42-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-42-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-42-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-42-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-42-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-42-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-42-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-42-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-42-10">10</a></span>
<span class="normal"><a href="#__codelineno-42-11">11</a></span>
<span class="normal"><a href="#__codelineno-42-12">12</a></span>
<span class="normal"><a href="#__codelineno-42-13">13</a></span>
<span class="normal"><a href="#__codelineno-42-14">14</a></span>
<span class="normal"><a href="#__codelineno-42-15">15</a></span>
<span class="normal"><a href="#__codelineno-42-16">16</a></span>
<span class="normal"><a href="#__codelineno-42-17">17</a></span>
<span class="normal"><a href="#__codelineno-42-18">18</a></span>
<span class="normal"><a href="#__codelineno-42-19">19</a></span>
<span class="normal"><a href="#__codelineno-42-20">20</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="k">def</span> <span class="nf">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
<a id="__codelineno-42-2" name="__codelineno-42-2"></a>  <span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-42-3" name="__codelineno-42-3"></a><span class="sd">  Calculates model accuracy, precision, recall and f1 score of a binary classification model.</span>
<a id="__codelineno-42-4" name="__codelineno-42-4"></a>
<a id="__codelineno-42-5" name="__codelineno-42-5"></a><span class="sd">  Args:</span>
<a id="__codelineno-42-6" name="__codelineno-42-6"></a><span class="sd">  -----</span>
<a id="__codelineno-42-7" name="__codelineno-42-7"></a><span class="sd">  y_true = true labels in the form of a 1D array</span>
<a id="__codelineno-42-8" name="__codelineno-42-8"></a><span class="sd">  y_pred = predicted labels in the form of a 1D array</span>
<a id="__codelineno-42-9" name="__codelineno-42-9"></a>
<a id="__codelineno-42-10" name="__codelineno-42-10"></a><span class="sd">  Returns a dictionary of accuracy, precision, recall, f1-score.</span>
<a id="__codelineno-42-11" name="__codelineno-42-11"></a><span class="sd">  &quot;&quot;&quot;</span>
<a id="__codelineno-42-12" name="__codelineno-42-12"></a>  <span class="c1"># Calculate model accuracy</span>
<a id="__codelineno-42-13" name="__codelineno-42-13"></a>  <span class="n">model_accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<a id="__codelineno-42-14" name="__codelineno-42-14"></a>  <span class="c1"># Calculate model precision, recall and f1 score using &quot;weighted&quot; average</span>
<a id="__codelineno-42-15" name="__codelineno-42-15"></a>  <span class="n">model_precision</span><span class="p">,</span> <span class="n">model_recall</span><span class="p">,</span> <span class="n">model_f1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">precision_recall_fscore_support</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s2">&quot;weighted&quot;</span><span class="p">)</span>
<a id="__codelineno-42-16" name="__codelineno-42-16"></a>  <span class="n">model_results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">model_accuracy</span><span class="p">,</span>
<a id="__codelineno-42-17" name="__codelineno-42-17"></a>                  <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="n">model_precision</span><span class="p">,</span>
<a id="__codelineno-42-18" name="__codelineno-42-18"></a>                  <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="n">model_recall</span><span class="p">,</span>
<a id="__codelineno-42-19" name="__codelineno-42-19"></a>                  <span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="n">model_f1</span><span class="p">}</span>
<a id="__codelineno-42-20" name="__codelineno-42-20"></a>  <span class="k">return</span> <span class="n">model_results</span>
</code></pre></div>
</td></tr></table>
<p><a name="model-0"></a></p>
<h2 id="model-0-base-model"><strong>Model 0: Base Model</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1">1</a></span>
<span class="normal"><a href="#__codelineno-43-2">2</a></span>
<span class="normal"><a href="#__codelineno-43-3">3</a></span>
<span class="normal"><a href="#__codelineno-43-4">4</a></span>
<span class="normal"><a href="#__codelineno-43-5">5</a></span>
<span class="normal"><a href="#__codelineno-43-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="n">model_0</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
<a id="__codelineno-43-2" name="__codelineno-43-2"></a>                    <span class="p">(</span><span class="s2">&quot;tfidf&quot;</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">()),</span> <span class="c1"># convert words to numbers using tfidf</span>
<a id="__codelineno-43-3" name="__codelineno-43-3"></a>                    <span class="p">(</span><span class="s2">&quot;clf&quot;</span><span class="p">,</span> <span class="n">MultinomialNB</span><span class="p">())</span> <span class="c1"># model to text</span>
<a id="__codelineno-43-4" name="__codelineno-43-4"></a><span class="p">])</span>
<a id="__codelineno-43-5" name="__codelineno-43-5"></a>
<a id="__codelineno-43-6" name="__codelineno-43-6"></a><span class="n">model_0</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_sentences</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Pipeline(steps=[('tfidf', TfidfVectorizer()), ('clf', MultinomialNB())])
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span>
<span class="normal"><a href="#__codelineno-44-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="n">model_0_score</span> <span class="o">=</span> <span class="n">model_0</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">val_sentences</span><span class="p">,</span> <span class="n">val_labels</span><span class="p">)</span>
<a id="__codelineno-44-2" name="__codelineno-44-2"></a>
<a id="__codelineno-44-3" name="__codelineno-44-3"></a><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Model achieves an accuracy of: </span><span class="si">{</span><span class="n">model_0_score</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Model achieves an accuracy of: 58.42%
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="n">model_0_preds</span> <span class="o">=</span> <span class="n">model_0</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_sentences</span><span class="p">)</span>
<a id="__codelineno-45-2" name="__codelineno-45-2"></a>
<a id="__codelineno-45-3" name="__codelineno-45-3"></a><span class="n">model_0_preds</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([2, 3, 2, 2, 2, 2, 3, 3, 1, 2, 1, 1, 1, 3, 1, 4, 2, 2, 3, 2])
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">1</a></span>
<span class="normal"><a href="#__codelineno-46-2">2</a></span>
<span class="normal"><a href="#__codelineno-46-3">3</a></span>
<span class="normal"><a href="#__codelineno-46-4">4</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="n">model_0_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-46-2" name="__codelineno-46-2"></a>                                     <span class="n">y_pred</span><span class="o">=</span><span class="n">model_0_preds</span><span class="p">)</span>
<a id="__codelineno-46-3" name="__codelineno-46-3"></a>
<a id="__codelineno-46-4" name="__codelineno-46-4"></a><span class="n">model_0_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 58.41663462770729,
     'f1': 0.527826088485645,
     'precision': 0.5784302848556678,
     'recall': 0.5841663462770729}
</pre>
</div>

<p><a name="model-1"></a></p>
<h2 id="model-1-dense-model"><strong>Model 1: Dense Model</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_1">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-47-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-47-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-47-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-47-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-47-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-47-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-47-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-47-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-47-10">10</a></span>
<span class="normal"><a href="#__codelineno-47-11">11</a></span>
<span class="normal"><a href="#__codelineno-47-12">12</a></span>
<span class="normal"><a href="#__codelineno-47-13">13</a></span>
<span class="normal"><a href="#__codelineno-47-14">14</a></span>
<span class="normal"><a href="#__codelineno-47-15">15</a></span>
<span class="normal"><a href="#__codelineno-47-16">16</a></span>
<span class="normal"><a href="#__codelineno-47-17">17</a></span>
<span class="normal"><a href="#__codelineno-47-18">18</a></span>
<span class="normal"><a href="#__codelineno-47-19">19</a></span>
<span class="normal"><a href="#__codelineno-47-20">20</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1"></a><span class="c1"># Create Model</span>
<a id="__codelineno-47-2" name="__codelineno-47-2"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-47-3" name="__codelineno-47-3"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-47-4" name="__codelineno-47-4"></a><span class="n">x</span> <span class="o">=</span> <span class="n">embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-47-5" name="__codelineno-47-5"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv1D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;same&quot;</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-47-6" name="__codelineno-47-6"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GlobalAveragePooling1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-47-7" name="__codelineno-47-7"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-47-8" name="__codelineno-47-8"></a><span class="n">model_1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_1_dense&quot;</span><span class="p">)</span>
<a id="__codelineno-47-9" name="__codelineno-47-9"></a>
<a id="__codelineno-47-10" name="__codelineno-47-10"></a><span class="c1"># Compile Model</span>
<a id="__codelineno-47-11" name="__codelineno-47-11"></a><span class="n">model_1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-47-12" name="__codelineno-47-12"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-47-13" name="__codelineno-47-13"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<a id="__codelineno-47-14" name="__codelineno-47-14"></a>
<a id="__codelineno-47-15" name="__codelineno-47-15"></a><span class="c1"># Fit Model</span>
<a id="__codelineno-47-16" name="__codelineno-47-16"></a><span class="n">model_1_history</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-47-17" name="__codelineno-47-17"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-47-18" name="__codelineno-47-18"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-47-19" name="__codelineno-47-19"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-47-20" name="__codelineno-47-20"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 7s 14ms/step - loss: 0.8163 - accuracy: 0.6790 - val_loss: 1.0623 - val_accuracy: 0.5941
    Epoch 2/5
    390/390 [==============================] - 5s 13ms/step - loss: 0.6942 - accuracy: 0.7355 - val_loss: 1.0707 - val_accuracy: 0.5999
    Epoch 3/5
    390/390 [==============================] - 5s 13ms/step - loss: 0.6701 - accuracy: 0.7391 - val_loss: 1.0644 - val_accuracy: 0.6086
    Epoch 4/5
    390/390 [==============================] - 5s 13ms/step - loss: 0.6710 - accuracy: 0.7358 - val_loss: 1.0729 - val_accuracy: 0.6092
    Epoch 5/5
    390/390 [==============================] - 4s 11ms/step - loss: 0.6700 - accuracy: 0.7382 - val_loss: 1.0676 - val_accuracy: 0.6128
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_1">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-48-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1"></a><span class="n">model_1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Model: "model_1_dense"
    _________________________________________________________________
     Layer (type)                Output Shape              Param #   
    =================================================================
     input_8 (InputLayer)        [(None, 1)]               0         

     text_vectorization_2 (TextV  (None, 7)                0         
     ectorization)                                                   

     embedding (Embedding)       (None, 7, 128)            1280000   

     conv1d_3 (Conv1D)           (None, 7, 64)             41024     

     global_average_pooling1d_7   (None, 64)               0         
     (GlobalAveragePooling1D)                                        

     dense_6 (Dense)             (None, 5)                 325       

    =================================================================
    Total params: 1,321,349
    Trainable params: 1,321,349
    Non-trainable params: 0
    _________________________________________________________________
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-49-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1"></a><span class="n">model_1</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 6s 6ms/step - loss: 1.0706 - accuracy: 0.6065
    [1.0706146955490112, 0.6064975261688232]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-50-1">1</a></span>
<span class="normal"><a href="#__codelineno-50-2">2</a></span>
<span class="normal"><a href="#__codelineno-50-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-50-2" name="__codelineno-50-2"></a><span class="n">model_1_preds_probs</span> <span class="o">=</span> <span class="n">model_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-50-3" name="__codelineno-50-3"></a><span class="n">model_1_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[1.9305311e-04, 1.3319064e-02, 9.8583651e-01, 6.5004983e-04,
            1.3877313e-06],
           [6.5389890e-03, 3.3802222e-02, 2.9358345e-01, 2.9974866e-01,
            3.6632669e-01],
           [9.8111159e-06, 1.3208812e-02, 9.7980130e-01, 6.9636721e-03,
            1.6313677e-05],
           ...,
           [6.0354895e-03, 3.5133634e-02, 9.1607034e-01, 4.0553551e-02,
            2.2070031e-03],
           [6.9615606e-05, 6.0776556e-03, 9.8642236e-01, 7.3589659e-03,
            7.1344555e-05],
           [1.4558802e-05, 7.8385981e-04, 9.7653699e-01, 2.2338519e-02,
            3.2608182e-04]], dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-51-1">1</a></span>
<span class="normal"><a href="#__codelineno-51-2">2</a></span>
<span class="normal"><a href="#__codelineno-51-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-51-2" name="__codelineno-51-2"></a><span class="n">model_1_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_1_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-51-3" name="__codelineno-51-3"></a><span class="n">model_1_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 4, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-52-1">1</a></span>
<span class="normal"><a href="#__codelineno-52-2">2</a></span>
<span class="normal"><a href="#__codelineno-52-3">3</a></span>
<span class="normal"><a href="#__codelineno-52-4">4</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1"></a><span class="c1"># Calculate model_1 results</span>
<a id="__codelineno-52-2" name="__codelineno-52-2"></a><span class="n">model_1_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-52-3" name="__codelineno-52-3"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_1_preds</span><span class="p">)</span>
<a id="__codelineno-52-4" name="__codelineno-52-4"></a><span class="n">model_1_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.64975009611688,
     'f1': 0.5877308222671987,
     'precision': 0.5870404429801983,
     'recall': 0.6064975009611688}
</pre>
</div>

<p><a name="model-2"></a></p>
<h2 id="model-2-lstm-model"><strong>Model 2: LSTM Model</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_2">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-53-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-53-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-53-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-53-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-53-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-53-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-53-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-53-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-53-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-53-10">10</a></span>
<span class="normal"><a href="#__codelineno-53-11">11</a></span>
<span class="normal"><a href="#__codelineno-53-12">12</a></span>
<span class="normal"><a href="#__codelineno-53-13">13</a></span>
<span class="normal"><a href="#__codelineno-53-14">14</a></span>
<span class="normal"><a href="#__codelineno-53-15">15</a></span>
<span class="normal"><a href="#__codelineno-53-16">16</a></span>
<span class="normal"><a href="#__codelineno-53-17">17</a></span>
<span class="normal"><a href="#__codelineno-53-18">18</a></span>
<span class="normal"><a href="#__codelineno-53-19">19</a></span>
<span class="normal"><a href="#__codelineno-53-20">20</a></span>
<span class="normal"><a href="#__codelineno-53-21">21</a></span>
<span class="normal"><a href="#__codelineno-53-22">22</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1"></a><span class="c1"># Create Model</span>
<a id="__codelineno-53-2" name="__codelineno-53-2"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-53-3" name="__codelineno-53-3"></a>
<a id="__codelineno-53-4" name="__codelineno-53-4"></a><span class="n">model_2_embedding_layer</span> <span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-53-5" name="__codelineno-53-5"></a>                                   <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-53-6" name="__codelineno-53-6"></a>                                   <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<a id="__codelineno-53-7" name="__codelineno-53-7"></a>                                   <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span>
<a id="__codelineno-53-8" name="__codelineno-53-8"></a>                                   <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_2&quot;</span><span class="p">)</span>
<a id="__codelineno-53-9" name="__codelineno-53-9"></a>
<a id="__codelineno-53-10" name="__codelineno-53-10"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-53-11" name="__codelineno-53-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-53-12" name="__codelineno-53-12"></a><span class="n">x</span> <span class="o">=</span> <span class="n">model_2_embedding_layer</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-53-13" name="__codelineno-53-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">return_sequences</span><span class="o">=</span><span class="kc">True</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-53-14" name="__codelineno-53-14"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-53-15" name="__codelineno-53-15"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-53-16" name="__codelineno-53-16"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-53-17" name="__codelineno-53-17"></a><span class="n">model_2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_2&quot;</span><span class="p">)</span>
<a id="__codelineno-53-18" name="__codelineno-53-18"></a>
<a id="__codelineno-53-19" name="__codelineno-53-19"></a><span class="c1"># Compile Model</span>
<a id="__codelineno-53-20" name="__codelineno-53-20"></a><span class="n">model_2</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-53-21" name="__codelineno-53-21"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-53-22" name="__codelineno-53-22"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-54-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1"></a><span class="n">model_2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Model: "model_2"
    _________________________________________________________________
     Layer (type)                Output Shape              Param #   
    =================================================================
     input_19 (InputLayer)       [(None, 1)]               0         

     text_vectorization_2 (TextV  (None, 7)                0         
     ectorization)                                                   

     embedding_2 (Embedding)     (None, 7, 128)            1280000   

     lstm_7 (LSTM)               (None, 7, 64)             49408     

     lstm_8 (LSTM)               (None, 64)                33024     

     dense_20 (Dense)            (None, 64)                4160      

     dense_21 (Dense)            (None, 5)                 325       

    =================================================================
    Total params: 1,366,917
    Trainable params: 1,366,917
    Non-trainable params: 0
    _________________________________________________________________
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-55-1">1</a></span>
<span class="normal"><a href="#__codelineno-55-2">2</a></span>
<span class="normal"><a href="#__codelineno-55-3">3</a></span>
<span class="normal"><a href="#__codelineno-55-4">4</a></span>
<span class="normal"><a href="#__codelineno-55-5">5</a></span>
<span class="normal"><a href="#__codelineno-55-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-55-1" name="__codelineno-55-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-55-2" name="__codelineno-55-2"></a><span class="n">model_2_history</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-55-3" name="__codelineno-55-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-55-4" name="__codelineno-55-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-55-5" name="__codelineno-55-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-55-6" name="__codelineno-55-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 12s 19ms/step - loss: 1.2176 - accuracy: 0.5170 - val_loss: 1.1604 - val_accuracy: 0.5419
    Epoch 2/5
    390/390 [==============================] - 7s 17ms/step - loss: 1.0914 - accuracy: 0.5603 - val_loss: 1.0574 - val_accuracy: 0.5757
    Epoch 3/5
    390/390 [==============================] - 6s 15ms/step - loss: 1.0212 - accuracy: 0.5923 - val_loss: 0.9989 - val_accuracy: 0.6050
    Epoch 4/5
    390/390 [==============================] - 6s 16ms/step - loss: 0.9960 - accuracy: 0.5965 - val_loss: 0.9721 - val_accuracy: 0.6124
    Epoch 5/5
    390/390 [==============================] - 6s 15ms/step - loss: 0.9702 - accuracy: 0.6087 - val_loss: 0.9596 - val_accuracy: 0.6173
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_2">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-56-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-56-1" name="__codelineno-56-1"></a><span class="n">model_2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 8s 8ms/step - loss: 0.9704 - accuracy: 0.6052
    [0.9704336524009705, 0.6052159667015076]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-57-1">1</a></span>
<span class="normal"><a href="#__codelineno-57-2">2</a></span>
<span class="normal"><a href="#__codelineno-57-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-57-1" name="__codelineno-57-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-57-2" name="__codelineno-57-2"></a><span class="n">model_2_preds_probs</span> <span class="o">=</span> <span class="n">model_2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-57-3" name="__codelineno-57-3"></a><span class="n">model_2_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[0.00283598, 0.07304553, 0.84789914, 0.0739017 , 0.00231771],
           [0.03265076, 0.12858073, 0.25941348, 0.40953177, 0.16982323],
           [0.0015297 , 0.04871588, 0.877553  , 0.07039087, 0.00181051],
           ...,
           [0.00622776, 0.09688104, 0.7632776 , 0.1265    , 0.00711361],
           [0.00114031, 0.03657562, 0.86155367, 0.09820341, 0.00252694],
           [0.0010233 , 0.03343411, 0.8596933 , 0.10322569, 0.00262356]],
          dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-58-1">1</a></span>
<span class="normal"><a href="#__codelineno-58-2">2</a></span>
<span class="normal"><a href="#__codelineno-58-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-58-1" name="__codelineno-58-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-58-2" name="__codelineno-58-2"></a><span class="n">model_2_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_2_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-58-3" name="__codelineno-58-3"></a><span class="n">model_2_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-59-1">1</a></span>
<span class="normal"><a href="#__codelineno-59-2">2</a></span>
<span class="normal"><a href="#__codelineno-59-3">3</a></span>
<span class="normal"><a href="#__codelineno-59-4">4</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-59-1" name="__codelineno-59-1"></a><span class="c1"># Calculate model_1 results</span>
<a id="__codelineno-59-2" name="__codelineno-59-2"></a><span class="n">model_2_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-59-3" name="__codelineno-59-3"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_2_preds</span><span class="p">)</span>
<a id="__codelineno-59-4" name="__codelineno-59-4"></a><span class="n">model_2_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.521594258618485,
     'f1': 0.572325330030645,
     'precision': 0.5860164929809915,
     'recall': 0.6052159425861848}
</pre>
</div>

<p><a name="model-3"></a></p>
<h2 id="model-3-gru-model"><strong>Model 3: GRU Model</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_3">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-60-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-60-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-60-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-60-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-60-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-60-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-60-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-60-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-60-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-60-10">10</a></span>
<span class="normal"><a href="#__codelineno-60-11">11</a></span>
<span class="normal"><a href="#__codelineno-60-12">12</a></span>
<span class="normal"><a href="#__codelineno-60-13">13</a></span>
<span class="normal"><a href="#__codelineno-60-14">14</a></span>
<span class="normal"><a href="#__codelineno-60-15">15</a></span>
<span class="normal"><a href="#__codelineno-60-16">16</a></span>
<span class="normal"><a href="#__codelineno-60-17">17</a></span>
<span class="normal"><a href="#__codelineno-60-18">18</a></span>
<span class="normal"><a href="#__codelineno-60-19">19</a></span>
<span class="normal"><a href="#__codelineno-60-20">20</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-60-1" name="__codelineno-60-1"></a><span class="c1"># Create GRU model</span>
<a id="__codelineno-60-2" name="__codelineno-60-2"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-60-3" name="__codelineno-60-3"></a>
<a id="__codelineno-60-4" name="__codelineno-60-4"></a><span class="n">model_3_embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-60-5" name="__codelineno-60-5"></a>                                                          <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-60-6" name="__codelineno-60-6"></a>                                                          <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<a id="__codelineno-60-7" name="__codelineno-60-7"></a>                                                          <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span>
<a id="__codelineno-60-8" name="__codelineno-60-8"></a>                                                          <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_3&quot;</span><span class="p">)</span>
<a id="__codelineno-60-9" name="__codelineno-60-9"></a>
<a id="__codelineno-60-10" name="__codelineno-60-10"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-60-11" name="__codelineno-60-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-60-12" name="__codelineno-60-12"></a><span class="n">x</span> <span class="o">=</span> <span class="n">model_3_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-60-13" name="__codelineno-60-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GRU</span><span class="p">(</span><span class="mi">64</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span> 
<a id="__codelineno-60-14" name="__codelineno-60-14"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-60-15" name="__codelineno-60-15"></a><span class="n">model_3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_3_GRU&quot;</span><span class="p">)</span>
<a id="__codelineno-60-16" name="__codelineno-60-16"></a>
<a id="__codelineno-60-17" name="__codelineno-60-17"></a><span class="c1"># Compile GRU model</span>
<a id="__codelineno-60-18" name="__codelineno-60-18"></a><span class="n">model_3</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-60-19" name="__codelineno-60-19"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-60-20" name="__codelineno-60-20"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-61-1">1</a></span>
<span class="normal"><a href="#__codelineno-61-2">2</a></span>
<span class="normal"><a href="#__codelineno-61-3">3</a></span>
<span class="normal"><a href="#__codelineno-61-4">4</a></span>
<span class="normal"><a href="#__codelineno-61-5">5</a></span>
<span class="normal"><a href="#__codelineno-61-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-61-1" name="__codelineno-61-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-61-2" name="__codelineno-61-2"></a><span class="n">model_3_history</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-61-3" name="__codelineno-61-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-61-4" name="__codelineno-61-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-61-5" name="__codelineno-61-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-61-6" name="__codelineno-61-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 11s 15ms/step - loss: 1.2120 - accuracy: 0.5199 - val_loss: 1.1473 - val_accuracy: 0.5564
    Epoch 2/5
    390/390 [==============================] - 5s 12ms/step - loss: 1.0712 - accuracy: 0.5696 - val_loss: 1.0347 - val_accuracy: 0.5825
    Epoch 3/5
    390/390 [==============================] - 5s 14ms/step - loss: 1.0061 - accuracy: 0.5958 - val_loss: 0.9870 - val_accuracy: 0.6173
    Epoch 4/5
    390/390 [==============================] - 5s 14ms/step - loss: 0.9863 - accuracy: 0.6035 - val_loss: 0.9610 - val_accuracy: 0.6102
    Epoch 5/5
    390/390 [==============================] - 5s 13ms/step - loss: 0.9596 - accuracy: 0.6097 - val_loss: 0.9495 - val_accuracy: 0.6227
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_3">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-62-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-62-1" name="__codelineno-62-1"></a><span class="n">model_3</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 5s 5ms/step - loss: 0.9604 - accuracy: 0.6073
    [0.9603721499443054, 0.6073305010795593]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-63-1">1</a></span>
<span class="normal"><a href="#__codelineno-63-2">2</a></span>
<span class="normal"><a href="#__codelineno-63-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-63-1" name="__codelineno-63-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-63-2" name="__codelineno-63-2"></a><span class="n">model_3_preds_probs</span> <span class="o">=</span> <span class="n">model_3</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-63-3" name="__codelineno-63-3"></a><span class="n">model_3_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[2.9161463e-03, 6.5244637e-02, 8.7572753e-01, 5.4168783e-02,
            1.9428704e-03],
           [2.2429822e-02, 1.0223251e-01, 2.9721451e-01, 4.5166963e-01,
            1.2645350e-01],
           [1.4951621e-03, 4.4885967e-02, 8.8715839e-01, 6.4550117e-02,
            1.9102800e-03],
           ...,
           [5.6155669e-03, 7.1202658e-02, 8.2271177e-01, 9.3324393e-02,
            7.1455599e-03],
           [1.0670603e-03, 3.1873956e-02, 8.6895674e-01, 9.4899625e-02,
            3.2026239e-03],
           [5.1549362e-04, 1.7923854e-02, 8.8177752e-01, 9.6597664e-02,
            3.1854268e-03]], dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-64-1">1</a></span>
<span class="normal"><a href="#__codelineno-64-2">2</a></span>
<span class="normal"><a href="#__codelineno-64-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-64-1" name="__codelineno-64-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-64-2" name="__codelineno-64-2"></a><span class="n">model_3_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_3_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-64-3" name="__codelineno-64-3"></a><span class="n">model_3_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-65-1">1</a></span>
<span class="normal"><a href="#__codelineno-65-2">2</a></span>
<span class="normal"><a href="#__codelineno-65-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-65-1" name="__codelineno-65-1"></a><span class="n">model_3_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-65-2" name="__codelineno-65-2"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_3_preds</span><span class="p">)</span>
<a id="__codelineno-65-3" name="__codelineno-65-3"></a><span class="n">model_3_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.733051390490836,
     'f1': 0.5734404261877547,
     'precision': 0.5914002358668983,
     'recall': 0.6073305139049083}
</pre>
</div>

<p><a name="model-4"></a></p>
<h2 id="model-4-bi-directional-lstm-model"><strong>Model 4: Bi-Directional-LSTM Model</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_4">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-66-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-66-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-66-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-66-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-66-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-66-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-66-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-66-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-66-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-66-10">10</a></span>
<span class="normal"><a href="#__codelineno-66-11">11</a></span>
<span class="normal"><a href="#__codelineno-66-12">12</a></span>
<span class="normal"><a href="#__codelineno-66-13">13</a></span>
<span class="normal"><a href="#__codelineno-66-14">14</a></span>
<span class="normal"><a href="#__codelineno-66-15">15</a></span>
<span class="normal"><a href="#__codelineno-66-16">16</a></span>
<span class="normal"><a href="#__codelineno-66-17">17</a></span>
<span class="normal"><a href="#__codelineno-66-18">18</a></span>
<span class="normal"><a href="#__codelineno-66-19">19</a></span>
<span class="normal"><a href="#__codelineno-66-20">20</a></span>
<span class="normal"><a href="#__codelineno-66-21">21</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-66-1" name="__codelineno-66-1"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-66-2" name="__codelineno-66-2"></a>
<a id="__codelineno-66-3" name="__codelineno-66-3"></a><span class="n">model_4_embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-66-4" name="__codelineno-66-4"></a>                                     <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-66-5" name="__codelineno-66-5"></a>                                     <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<a id="__codelineno-66-6" name="__codelineno-66-6"></a>                                     <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span>
<a id="__codelineno-66-7" name="__codelineno-66-7"></a>                                     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_4&quot;</span><span class="p">)</span>
<a id="__codelineno-66-8" name="__codelineno-66-8"></a>
<a id="__codelineno-66-9" name="__codelineno-66-9"></a><span class="c1"># Build a Bidirectional RNN in TensorFlow</span>
<a id="__codelineno-66-10" name="__codelineno-66-10"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-66-11" name="__codelineno-66-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-66-12" name="__codelineno-66-12"></a><span class="n">x</span> <span class="o">=</span> <span class="n">model_4_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-66-13" name="__codelineno-66-13"></a><span class="c1"># x = layers.Bidirectional(layers.LSTM(64, return_sequences=True))(x) # stacking RNN layers requires return_sequences=True</span>
<a id="__codelineno-66-14" name="__codelineno-66-14"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">LSTM</span><span class="p">(</span><span class="mi">64</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># bidirectional goes both ways so has double the parameters of a regular LSTM layer</span>
<a id="__codelineno-66-15" name="__codelineno-66-15"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-66-16" name="__codelineno-66-16"></a><span class="n">model_4</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_4_Bidirectional&quot;</span><span class="p">)</span>
<a id="__codelineno-66-17" name="__codelineno-66-17"></a>
<a id="__codelineno-66-18" name="__codelineno-66-18"></a><span class="c1"># Compile</span>
<a id="__codelineno-66-19" name="__codelineno-66-19"></a><span class="n">model_4</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-66-20" name="__codelineno-66-20"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-66-21" name="__codelineno-66-21"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-67-1">1</a></span>
<span class="normal"><a href="#__codelineno-67-2">2</a></span>
<span class="normal"><a href="#__codelineno-67-3">3</a></span>
<span class="normal"><a href="#__codelineno-67-4">4</a></span>
<span class="normal"><a href="#__codelineno-67-5">5</a></span>
<span class="normal"><a href="#__codelineno-67-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-67-1" name="__codelineno-67-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-67-2" name="__codelineno-67-2"></a><span class="n">model_4_history</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-67-3" name="__codelineno-67-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-67-4" name="__codelineno-67-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-67-5" name="__codelineno-67-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-67-6" name="__codelineno-67-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 9s 14ms/step - loss: 1.1955 - accuracy: 0.5248 - val_loss: 1.1071 - val_accuracy: 0.5657
    Epoch 2/5
    390/390 [==============================] - 4s 11ms/step - loss: 1.0570 - accuracy: 0.5760 - val_loss: 1.0233 - val_accuracy: 0.5844
    Epoch 3/5
    390/390 [==============================] - 4s 11ms/step - loss: 1.0009 - accuracy: 0.5973 - val_loss: 0.9810 - val_accuracy: 0.6105
    Epoch 4/5
    390/390 [==============================] - 4s 11ms/step - loss: 0.9805 - accuracy: 0.6010 - val_loss: 0.9578 - val_accuracy: 0.6160
    Epoch 5/5
    390/390 [==============================] - 4s 11ms/step - loss: 0.9572 - accuracy: 0.6139 - val_loss: 0.9435 - val_accuracy: 0.6198
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_4">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-68-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-68-1" name="__codelineno-68-1"></a><span class="n">model_4</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 5s 6ms/step - loss: 0.9542 - accuracy: 0.6091
    [0.954213559627533, 0.6091247200965881]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-69-1">1</a></span>
<span class="normal"><a href="#__codelineno-69-2">2</a></span>
<span class="normal"><a href="#__codelineno-69-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-69-1" name="__codelineno-69-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-69-2" name="__codelineno-69-2"></a><span class="n">model_4_preds_probs</span> <span class="o">=</span> <span class="n">model_4</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-69-3" name="__codelineno-69-3"></a><span class="n">model_4_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[6.88493066e-03, 9.40518752e-02, 8.35097075e-01, 6.12860657e-02,
            2.67998874e-03],
           [2.53966469e-02, 1.19336866e-01, 2.86787868e-01, 4.30427819e-01,
            1.38050839e-01],
           [1.25894789e-03, 3.44616100e-02, 9.00816023e-01, 6.18455261e-02,
            1.61787507e-03],
           ...,
           [7.80235417e-03, 8.82898793e-02, 7.79746771e-01, 1.15226217e-01,
            8.93473066e-03],
           [1.18823466e-03, 2.65664235e-02, 8.72716546e-01, 9.61883515e-02,
            3.34034883e-03],
           [4.35549387e-04, 1.34989144e-02, 8.71530533e-01, 1.10774204e-01,
            3.76072875e-03]], dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-70-1">1</a></span>
<span class="normal"><a href="#__codelineno-70-2">2</a></span>
<span class="normal"><a href="#__codelineno-70-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-70-1" name="__codelineno-70-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-70-2" name="__codelineno-70-2"></a><span class="n">model_4_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_4_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-70-3" name="__codelineno-70-3"></a><span class="n">model_4_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-71-1">1</a></span>
<span class="normal"><a href="#__codelineno-71-2">2</a></span>
<span class="normal"><a href="#__codelineno-71-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-71-1" name="__codelineno-71-1"></a><span class="n">model_4_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-71-2" name="__codelineno-71-2"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_4_preds</span><span class="p">)</span>
<a id="__codelineno-71-3" name="__codelineno-71-3"></a><span class="n">model_4_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.91246956298859,
     'f1': 0.575905511191332,
     'precision': 0.5921140410067077,
     'recall': 0.6091246956298859}
</pre>
</div>

<p><a name="model-5"></a></p>
<h2 id="model-5-1d-cnn"><strong>Model 5: 1D CNN</strong></h2>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_5">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-72-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-72-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-72-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-72-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-72-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-72-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-72-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-72-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-72-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-72-10">10</a></span>
<span class="normal"><a href="#__codelineno-72-11">11</a></span>
<span class="normal"><a href="#__codelineno-72-12">12</a></span>
<span class="normal"><a href="#__codelineno-72-13">13</a></span>
<span class="normal"><a href="#__codelineno-72-14">14</a></span>
<span class="normal"><a href="#__codelineno-72-15">15</a></span>
<span class="normal"><a href="#__codelineno-72-16">16</a></span>
<span class="normal"><a href="#__codelineno-72-17">17</a></span>
<span class="normal"><a href="#__codelineno-72-18">18</a></span>
<span class="normal"><a href="#__codelineno-72-19">19</a></span>
<span class="normal"><a href="#__codelineno-72-20">20</a></span>
<span class="normal"><a href="#__codelineno-72-21">21</a></span>
<span class="normal"><a href="#__codelineno-72-22">22</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-72-1" name="__codelineno-72-1"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-72-2" name="__codelineno-72-2"></a>
<a id="__codelineno-72-3" name="__codelineno-72-3"></a><span class="n">model_5_embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-72-4" name="__codelineno-72-4"></a>                                     <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-72-5" name="__codelineno-72-5"></a>                                     <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<a id="__codelineno-72-6" name="__codelineno-72-6"></a>                                     <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span>
<a id="__codelineno-72-7" name="__codelineno-72-7"></a>                                     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_5&quot;</span><span class="p">)</span>
<a id="__codelineno-72-8" name="__codelineno-72-8"></a>
<a id="__codelineno-72-9" name="__codelineno-72-9"></a><span class="c1"># Create 1-dimensional convolutional layer to model sequences</span>
<a id="__codelineno-72-10" name="__codelineno-72-10"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-72-11" name="__codelineno-72-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-72-12" name="__codelineno-72-12"></a><span class="n">x</span> <span class="o">=</span> <span class="n">model_5_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-72-13" name="__codelineno-72-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Conv1D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-72-14" name="__codelineno-72-14"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GlobalMaxPool1D</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-72-15" name="__codelineno-72-15"></a><span class="c1"># x = layers.Dense(64, activation=&quot;relu&quot;)(x) # optional dense layer</span>
<a id="__codelineno-72-16" name="__codelineno-72-16"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-72-17" name="__codelineno-72-17"></a><span class="n">model_5</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_5_Conv1D&quot;</span><span class="p">)</span>
<a id="__codelineno-72-18" name="__codelineno-72-18"></a>
<a id="__codelineno-72-19" name="__codelineno-72-19"></a><span class="c1"># Compile</span>
<a id="__codelineno-72-20" name="__codelineno-72-20"></a><span class="n">model_5</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-72-21" name="__codelineno-72-21"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-72-22" name="__codelineno-72-22"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-73-1">1</a></span>
<span class="normal"><a href="#__codelineno-73-2">2</a></span>
<span class="normal"><a href="#__codelineno-73-3">3</a></span>
<span class="normal"><a href="#__codelineno-73-4">4</a></span>
<span class="normal"><a href="#__codelineno-73-5">5</a></span>
<span class="normal"><a href="#__codelineno-73-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-73-1" name="__codelineno-73-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-73-2" name="__codelineno-73-2"></a><span class="n">model_5_history</span> <span class="o">=</span> <span class="n">model_5</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-73-3" name="__codelineno-73-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-73-4" name="__codelineno-73-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-73-5" name="__codelineno-73-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-73-6" name="__codelineno-73-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
Epoch 1/5
    390/390 [==============================] - 4s 7ms/step - loss: 1.2414 - accuracy: 0.5133 - val_loss: 1.1770 - val_accuracy: 0.5403
    Epoch 2/5
    390/390 [==============================] - 3s 7ms/step - loss: 1.1067 - accuracy: 0.5595 - val_loss: 1.0612 - val_accuracy: 0.5834
    Epoch 3/5
    390/390 [==============================] - 3s 8ms/step - loss: 1.0267 - accuracy: 0.5881 - val_loss: 1.0047 - val_accuracy: 0.6105
    Epoch 4/5
    390/390 [==============================] - 3s 7ms/step - loss: 1.0061 - accuracy: 0.5942 - val_loss: 0.9799 - val_accuracy: 0.6134
    Epoch 5/5
    390/390 [==============================] - 3s 7ms/step - loss: 0.9755 - accuracy: 0.6077 - val_loss: 0.9659 - val_accuracy: 0.6063
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_5">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-74-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-74-1" name="__codelineno-74-1"></a><span class="n">model_5</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 4s 4ms/step - loss: 0.9737 - accuracy: 0.6011
    [0.9736706018447876, 0.6010829210281372]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-75-1">1</a></span>
<span class="normal"><a href="#__codelineno-75-2">2</a></span>
<span class="normal"><a href="#__codelineno-75-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-75-1" name="__codelineno-75-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-75-2" name="__codelineno-75-2"></a><span class="n">model_5_preds_probs</span> <span class="o">=</span> <span class="n">model_5</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-75-3" name="__codelineno-75-3"></a><span class="n">model_5_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[0.01402147, 0.12598462, 0.7931574 , 0.06416978, 0.00266677],
           [0.05536345, 0.11635033, 0.2575668 , 0.35425842, 0.21646096],
           [0.00169773, 0.04365515, 0.88836193, 0.06431493, 0.00197031],
           ...,
           [0.00813777, 0.07615034, 0.8226522 , 0.08706694, 0.0059927 ],
           [0.00339187, 0.03849348, 0.86329603, 0.08950879, 0.00530978],
           [0.00168913, 0.02522396, 0.8227081 , 0.14269303, 0.00768579]],
          dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-76-1">1</a></span>
<span class="normal"><a href="#__codelineno-76-2">2</a></span>
<span class="normal"><a href="#__codelineno-76-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-76-1" name="__codelineno-76-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-76-2" name="__codelineno-76-2"></a><span class="n">model_5_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_5_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-76-3" name="__codelineno-76-3"></a><span class="n">model_5_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-77-1">1</a></span>
<span class="normal"><a href="#__codelineno-77-2">2</a></span>
<span class="normal"><a href="#__codelineno-77-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-77-1" name="__codelineno-77-1"></a><span class="n">model_5_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-77-2" name="__codelineno-77-2"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_5_preds</span><span class="p">)</span>
<a id="__codelineno-77-3" name="__codelineno-77-3"></a><span class="n">model_5_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.10829168268614,
     'f1': 0.56192463092558,
     'precision': 0.5793963580163349,
     'recall': 0.6010829168268614}
</pre>
</div>

<p><a name="model-6"></a></p>
<h2 id="model-6-tensorflow-hub-pretrained-model-use"><strong>Model 6: TensorFlow Hub Pretrained Model (USE)</strong></h2>
<p>Universal Sentence Encoder (USE)</p>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_6">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-78-1">1</a></span>
<span class="normal"><a href="#__codelineno-78-2">2</a></span>
<span class="normal"><a href="#__codelineno-78-3">3</a></span>
<span class="normal"><a href="#__codelineno-78-4">4</a></span>
<span class="normal"><a href="#__codelineno-78-5">5</a></span>
<span class="normal"><a href="#__codelineno-78-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-78-1" name="__codelineno-78-1"></a><span class="c1"># We can use this encoding layer in place of our text_vectorizer and embedding layer</span>
<a id="__codelineno-78-2" name="__codelineno-78-2"></a><span class="n">sentence_encoder_layer</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">KerasLayer</span><span class="p">(</span><span class="s2">&quot;https://tfhub.dev/google/universal-sentence-encoder/4&quot;</span><span class="p">,</span>
<a id="__codelineno-78-3" name="__codelineno-78-3"></a>                                        <span class="n">input_shape</span><span class="o">=</span><span class="p">[],</span> <span class="c1"># shape of inputs coming to our model </span>
<a id="__codelineno-78-4" name="__codelineno-78-4"></a>                                        <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">,</span> <span class="c1"># data type of inputs coming to the USE layer</span>
<a id="__codelineno-78-5" name="__codelineno-78-5"></a>                                        <span class="n">trainable</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1"># keep the pretrained weights (we&#39;ll create a feature extractor)</span>
<a id="__codelineno-78-6" name="__codelineno-78-6"></a>                                        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;USE&quot;</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-79-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-79-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-79-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-79-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-79-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-79-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-79-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-79-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-79-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-79-10">10</a></span>
<span class="normal"><a href="#__codelineno-79-11">11</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-79-1" name="__codelineno-79-1"></a><span class="c1"># Create model using the Sequential API</span>
<a id="__codelineno-79-2" name="__codelineno-79-2"></a><span class="n">model_6</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
<a id="__codelineno-79-3" name="__codelineno-79-3"></a>                               <span class="n">sentence_encoder_layer</span><span class="p">,</span> <span class="c1"># take in sentences and then encode them into an embedding</span>
<a id="__codelineno-79-4" name="__codelineno-79-4"></a>                               <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">),</span>
<a id="__codelineno-79-5" name="__codelineno-79-5"></a>                               <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>
<a id="__codelineno-79-6" name="__codelineno-79-6"></a>                               <span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_6_USE&quot;</span><span class="p">)</span>
<a id="__codelineno-79-7" name="__codelineno-79-7"></a>
<a id="__codelineno-79-8" name="__codelineno-79-8"></a><span class="c1"># Compile</span>
<a id="__codelineno-79-9" name="__codelineno-79-9"></a><span class="n">model_6</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-79-10" name="__codelineno-79-10"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-79-11" name="__codelineno-79-11"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-80-1">1</a></span>
<span class="normal"><a href="#__codelineno-80-2">2</a></span>
<span class="normal"><a href="#__codelineno-80-3">3</a></span>
<span class="normal"><a href="#__codelineno-80-4">4</a></span>
<span class="normal"><a href="#__codelineno-80-5">5</a></span>
<span class="normal"><a href="#__codelineno-80-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-80-1" name="__codelineno-80-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-80-2" name="__codelineno-80-2"></a><span class="n">model_6_history</span> <span class="o">=</span> <span class="n">model_6</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-80-3" name="__codelineno-80-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-80-4" name="__codelineno-80-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-80-5" name="__codelineno-80-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-80-6" name="__codelineno-80-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 12s 19ms/step - loss: 1.1254 - accuracy: 0.5555 - val_loss: 0.9791 - val_accuracy: 0.6121
    Epoch 2/5
    390/390 [==============================] - 7s 18ms/step - loss: 0.9676 - accuracy: 0.5969 - val_loss: 0.9405 - val_accuracy: 0.6070
    Epoch 3/5
    390/390 [==============================] - 7s 18ms/step - loss: 0.9415 - accuracy: 0.6139 - val_loss: 0.9284 - val_accuracy: 0.6092
    Epoch 4/5
    390/390 [==============================] - 7s 18ms/step - loss: 0.9423 - accuracy: 0.6155 - val_loss: 0.9222 - val_accuracy: 0.6198
    Epoch 5/5
    390/390 [==============================] - 7s 19ms/step - loss: 0.9283 - accuracy: 0.6171 - val_loss: 0.9209 - val_accuracy: 0.6179
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_6">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-81-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-81-1" name="__codelineno-81-1"></a><span class="n">model_6</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 15s 15ms/step - loss: 0.9349 - accuracy: 0.6112
    [0.9349470138549805, 0.6112392544746399]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-82-1">1</a></span>
<span class="normal"><a href="#__codelineno-82-2">2</a></span>
<span class="normal"><a href="#__codelineno-82-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-82-1" name="__codelineno-82-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-82-2" name="__codelineno-82-2"></a><span class="n">model_6_preds_probs</span> <span class="o">=</span> <span class="n">model_6</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-82-3" name="__codelineno-82-3"></a><span class="n">model_6_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[4.08442169e-02, 2.84134716e-01, 6.23343170e-01, 5.00717126e-02,
            1.60614739e-03],
           [6.79622078e-03, 3.45214754e-02, 1.53381526e-01, 5.27396381e-01,
            2.77904332e-01],
           [5.70350785e-05, 6.81295758e-03, 9.46337581e-01, 4.61474918e-02,
            6.44808460e-04],
           ...,
           [1.12251681e-03, 1.56435966e-02, 6.96158469e-01, 2.40043879e-01,
            4.70314920e-02],
           [2.44216935e-04, 1.76663548e-02, 8.61079156e-01, 1.18701905e-01,
            2.30850209e-03],
           [4.14435426e-03, 1.18305087e-01, 8.36907208e-01, 4.01645638e-02,
            4.78762056e-04]], dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-83-1">1</a></span>
<span class="normal"><a href="#__codelineno-83-2">2</a></span>
<span class="normal"><a href="#__codelineno-83-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-83-1" name="__codelineno-83-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-83-2" name="__codelineno-83-2"></a><span class="n">model_6_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_6_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-83-3" name="__codelineno-83-3"></a><span class="n">model_6_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-84-1">1</a></span>
<span class="normal"><a href="#__codelineno-84-2">2</a></span>
<span class="normal"><a href="#__codelineno-84-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-84-1" name="__codelineno-84-1"></a><span class="n">model_6_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-84-2" name="__codelineno-84-2"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_6_preds</span><span class="p">)</span>
<a id="__codelineno-84-3" name="__codelineno-84-3"></a><span class="n">model_6_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 61.123926694860955,
     'f1': 0.5905043403092993,
     'precision': 0.5925993374652402,
     'recall': 0.6112392669486095}
</pre>
</div>

<p><a name="model-7"></a></p>
<h2 id="model-7-kaggle-model"><strong>Model 7: Kaggle Model</strong></h2>
<p>Source <a href="https://www.kaggle.com/michalbrezk/natural-language-processing-with-bi-gru-top-10">here</a></p>
<p><a name=""></a></p>
<h3 id="create-compile-and-run-model_7">Create, Compile, and Run Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-85-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-85-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-85-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-85-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-85-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-85-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-85-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-85-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-85-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-85-10">10</a></span>
<span class="normal"><a href="#__codelineno-85-11">11</a></span>
<span class="normal"><a href="#__codelineno-85-12">12</a></span>
<span class="normal"><a href="#__codelineno-85-13">13</a></span>
<span class="normal"><a href="#__codelineno-85-14">14</a></span>
<span class="normal"><a href="#__codelineno-85-15">15</a></span>
<span class="normal"><a href="#__codelineno-85-16">16</a></span>
<span class="normal"><a href="#__codelineno-85-17">17</a></span>
<span class="normal"><a href="#__codelineno-85-18">18</a></span>
<span class="normal"><a href="#__codelineno-85-19">19</a></span>
<span class="normal"><a href="#__codelineno-85-20">20</a></span>
<span class="normal"><a href="#__codelineno-85-21">21</a></span>
<span class="normal"><a href="#__codelineno-85-22">22</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-85-1" name="__codelineno-85-1"></a><span class="n">tf</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-85-2" name="__codelineno-85-2"></a>
<a id="__codelineno-85-3" name="__codelineno-85-3"></a><span class="n">model_7_embedding</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Embedding</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">max_vocab_length</span><span class="p">,</span>
<a id="__codelineno-85-4" name="__codelineno-85-4"></a>                                     <span class="n">output_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
<a id="__codelineno-85-5" name="__codelineno-85-5"></a>                                     <span class="n">embeddings_initializer</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span>
<a id="__codelineno-85-6" name="__codelineno-85-6"></a>                                     <span class="n">input_length</span><span class="o">=</span><span class="n">max_length</span><span class="p">,</span>
<a id="__codelineno-85-7" name="__codelineno-85-7"></a>                                     <span class="n">name</span><span class="o">=</span><span class="s2">&quot;embedding_7&quot;</span><span class="p">)</span>
<a id="__codelineno-85-8" name="__codelineno-85-8"></a>
<a id="__codelineno-85-9" name="__codelineno-85-9"></a><span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<a id="__codelineno-85-10" name="__codelineno-85-10"></a><span class="n">x</span> <span class="o">=</span> <span class="n">text_vectorizer</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<a id="__codelineno-85-11" name="__codelineno-85-11"></a><span class="n">x</span> <span class="o">=</span> <span class="n">model_7_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-12" name="__codelineno-85-12"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">SpatialDropout1D</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-13" name="__codelineno-85-13"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Bidirectional</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">GRU</span><span class="p">(</span><span class="mi">128</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-14" name="__codelineno-85-14"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-15" name="__codelineno-85-15"></a><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-16" name="__codelineno-85-16"></a><span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_classes</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<a id="__codelineno-85-17" name="__codelineno-85-17"></a><span class="n">model_7</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model_7_Bidirectional&quot;</span><span class="p">)</span>
<a id="__codelineno-85-18" name="__codelineno-85-18"></a>
<a id="__codelineno-85-19" name="__codelineno-85-19"></a><span class="c1"># Compile</span>
<a id="__codelineno-85-20" name="__codelineno-85-20"></a><span class="n">model_7</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">,</span>
<a id="__codelineno-85-21" name="__codelineno-85-21"></a>                <span class="n">optimizer</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(),</span>
<a id="__codelineno-85-22" name="__codelineno-85-22"></a>                <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-86-1">1</a></span>
<span class="normal"><a href="#__codelineno-86-2">2</a></span>
<span class="normal"><a href="#__codelineno-86-3">3</a></span>
<span class="normal"><a href="#__codelineno-86-4">4</a></span>
<span class="normal"><a href="#__codelineno-86-5">5</a></span>
<span class="normal"><a href="#__codelineno-86-6">6</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-86-1" name="__codelineno-86-1"></a><span class="c1"># Run Model</span>
<a id="__codelineno-86-2" name="__codelineno-86-2"></a><span class="n">model_7_history</span> <span class="o">=</span> <span class="n">model_7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span>
<a id="__codelineno-86-3" name="__codelineno-86-3"></a>                              <span class="n">steps_per_epoch</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">)),</span>
<a id="__codelineno-86-4" name="__codelineno-86-4"></a>                              <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<a id="__codelineno-86-5" name="__codelineno-86-5"></a>                              <span class="n">validation_data</span><span class="o">=</span><span class="n">val_dataset</span><span class="p">,</span>
<a id="__codelineno-86-6" name="__codelineno-86-6"></a>                              <span class="n">validation_steps</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)))</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    Epoch 1/5
    390/390 [==============================] - 11s 18ms/step - loss: 1.2026 - accuracy: 0.5244 - val_loss: 1.1104 - val_accuracy: 0.5635
    Epoch 2/5
    390/390 [==============================] - 6s 16ms/step - loss: 1.0750 - accuracy: 0.5688 - val_loss: 1.0346 - val_accuracy: 0.5815
    Epoch 3/5
    390/390 [==============================] - 6s 16ms/step - loss: 1.0152 - accuracy: 0.5914 - val_loss: 0.9878 - val_accuracy: 0.6115
    Epoch 4/5
    390/390 [==============================] - 6s 14ms/step - loss: 0.9952 - accuracy: 0.5949 - val_loss: 0.9689 - val_accuracy: 0.6147
    Epoch 5/5
    390/390 [==============================] - 5s 12ms/step - loss: 0.9655 - accuracy: 0.6061 - val_loss: 0.9532 - val_accuracy: 0.6198
</pre>
</div>

<p><a name=""></a></p>
<h3 id="evaluate-model_7">Evaluate Model</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-87-1">1</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-87-1" name="__codelineno-87-1"></a><span class="n">model_7</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    976/976 [==============================] - 6s 6ms/step - loss: 0.9623 - accuracy: 0.6071
    [0.9622707962989807, 0.6070742011070251]
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-88-1">1</a></span>
<span class="normal"><a href="#__codelineno-88-2">2</a></span>
<span class="normal"><a href="#__codelineno-88-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-88-1" name="__codelineno-88-1"></a><span class="c1"># Make prediction (output as probability)</span>
<a id="__codelineno-88-2" name="__codelineno-88-2"></a><span class="n">model_7_preds_probs</span> <span class="o">=</span> <span class="n">model_7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">)</span>
<a id="__codelineno-88-3" name="__codelineno-88-3"></a><span class="n">model_7_preds_probs</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    array([[4.81974194e-03, 1.02668062e-01, 7.86542535e-01, 1.02067225e-01,
            3.90241458e-03],
           [3.19093950e-02, 1.18430942e-01, 3.38088363e-01, 3.72188181e-01,
            1.39383137e-01],
           [5.74855076e-04, 3.53298075e-02, 9.07475293e-01, 5.59109673e-02,
            7.09129323e-04],
           ...,
           [6.73797308e-03, 1.04207650e-01, 7.42672443e-01, 1.38572186e-01,
            7.80967670e-03],
           [7.03967118e-04, 2.67223120e-02, 8.50270391e-01, 1.19842947e-01,
            2.46028812e-03],
           [4.04282036e-04, 1.77792106e-02, 8.62546921e-01, 1.17260851e-01,
            2.00870004e-03]], dtype=float32)
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-89-1">1</a></span>
<span class="normal"><a href="#__codelineno-89-2">2</a></span>
<span class="normal"><a href="#__codelineno-89-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-89-1" name="__codelineno-89-1"></a><span class="c1"># Convert pred_probs to classes</span>
<a id="__codelineno-89-2" name="__codelineno-89-2"></a><span class="n">model_7_preds</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">model_7_preds_probs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-89-3" name="__codelineno-89-3"></a><span class="n">model_7_preds</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    (tf.Tensor: shape=(31212,), dtype=int64, numpy=array([2, 3, 2, ..., 2, 2, 2]))
</pre>
</div>

<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-90-1">1</a></span>
<span class="normal"><a href="#__codelineno-90-2">2</a></span>
<span class="normal"><a href="#__codelineno-90-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-90-1" name="__codelineno-90-1"></a><span class="n">model_7_results</span> <span class="o">=</span> <span class="n">calculate_results</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">val_labels</span><span class="p">,</span>
<a id="__codelineno-90-2" name="__codelineno-90-2"></a>                                    <span class="n">y_pred</span><span class="o">=</span><span class="n">model_7_preds</span><span class="p">)</span>
<a id="__codelineno-90-3" name="__codelineno-90-3"></a><span class="n">model_7_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
    {'accuracy': 60.70742022299116,
     'f1': 0.5675331419908787,
     'precision': 0.5902135161948232,
     'recall': 0.6070742022299116}
</pre>
</div>

<p><a name="compare-models"></a></p>
<h2 id="compare-all-models"><strong>Compare All Models</strong></h2>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-91-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-91-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-91-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-91-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-91-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-91-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-91-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-91-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-91-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-91-10">10</a></span>
<span class="normal"><a href="#__codelineno-91-11">11</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-91-1" name="__codelineno-91-1"></a><span class="c1"># Combine model results into a DataFrame</span>
<a id="__codelineno-91-2" name="__codelineno-91-2"></a><span class="n">all_model_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="n">model_0_results</span><span class="p">,</span>
<a id="__codelineno-91-3" name="__codelineno-91-3"></a>                                  <span class="s2">&quot;dense&quot;</span><span class="p">:</span> <span class="n">model_1_results</span><span class="p">,</span>
<a id="__codelineno-91-4" name="__codelineno-91-4"></a>                                  <span class="s2">&quot;lstm&quot;</span><span class="p">:</span> <span class="n">model_2_results</span><span class="p">,</span>
<a id="__codelineno-91-5" name="__codelineno-91-5"></a>                                  <span class="s2">&quot;gru&quot;</span><span class="p">:</span> <span class="n">model_3_results</span><span class="p">,</span>
<a id="__codelineno-91-6" name="__codelineno-91-6"></a>                                  <span class="s2">&quot;bidirectional&quot;</span><span class="p">:</span> <span class="n">model_4_results</span><span class="p">,</span>
<a id="__codelineno-91-7" name="__codelineno-91-7"></a>                                  <span class="s2">&quot;conv1d&quot;</span><span class="p">:</span> <span class="n">model_5_results</span><span class="p">,</span>
<a id="__codelineno-91-8" name="__codelineno-91-8"></a>                                  <span class="s2">&quot;tf_hub_sentence_encoder&quot;</span><span class="p">:</span> <span class="n">model_6_results</span><span class="p">,</span>
<a id="__codelineno-91-9" name="__codelineno-91-9"></a>                                  <span class="s2">&quot;kaggle&quot;</span><span class="p">:</span> <span class="n">model_7_results</span><span class="p">})</span>
<a id="__codelineno-91-10" name="__codelineno-91-10"></a><span class="n">all_model_results</span> <span class="o">=</span> <span class="n">all_model_results</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<a id="__codelineno-91-11" name="__codelineno-91-11"></a><span class="n">all_model_results</span>
</code></pre></div>
</td></tr></table>
<div class="test">
<pre id="__code_7">
                            accuracy    precision   recall      f1
    base                    58.416635   0.578430    0.584166    0.527826
    dense                   60.649750   0.587040    0.606498    0.587731
    lstm                    60.521594   0.586016    0.605216    0.572325
    gru                     60.733051   0.591400    0.607331    0.573440
    bidirectional           60.912470   0.592114    0.609125    0.575906
    conv1d                  60.108292   0.579396    0.601083    0.561925
    tf_hub_sentence_encoder 61.123927   0.592599    0.611239    0.590504
    kaggle                  60.707420   0.590214    0.607074    0.567533
</pre>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../nlp-2-multi/" class="md-footer__link md-footer__link--prev" aria-label="Previous: NLP - Multi-Class PedMed" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              NLP - Multi-Class PedMed
            </div>
          </div>
        </a>
      
      
        
        <a href="../ts-bitcoin/" class="md-footer__link md-footer__link--next" aria-label="Next: Time Series - Bitcoin Price Forecast" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Time Series - Bitcoin Price Forecast
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2022 Mark Schwarz
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["search.suggest", "search.highlight", "search.tabs.link", "content.tabs.link", "navigation.indexes", "navigation.tabs", "navigation.top"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.cefbb252.min.js"}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.a5f8ea78.min.js"></script>
      
    
  </body>
</html>